{% if projects %}
<div class="card">
    <div class="card-body">
        <span>Denna mapp innehåller följande projekt:</span>
        <form action="{{ url_for('repo_content', owner=owner, repo_name=repo_name) }}" method="post" id="editProject">
            <select name="project" id="project" class="form-select form-select-lg mb-3">
                {% for project in projects %}
                <option value='{{project | tojson }}'>{{project.name}}</option>
                {% endfor %}
            </select>
            <button type="submit" class="mb-3">Redigera projekt</button>
            <div class="d-flex flex-column flex-sm-row align-items-center mb-3">
                <select name="exportCRS" id="exportCRS" class="form-select form-select-lg flex-grow-1 mb-3 mb-sm-0">
                    <option value="EPSG:3006" {% if settingsCRS=="EPSG:3006" %}selected{% endif %}>
                        SWEREF 99 TM</option>
                    <option value="EPSG:3008" {% if settingsCRS=="EPSG:3008" %}selected{% endif %}>
                        SWEREF 99 13 30</option>
                    <option value="EPSG:3009" {% if settingsCRS=="EPSG:3009" %}selected{% endif %}>
                        SWEREF 99 15 00</option>
                    <option value="EPSG:5845" {% if settingsCRS=="EPSG:5845" %}selected{% endif %}>
                        SWEREF 99 TM + RH2000 height</option>
                    <option value="EPSG:5847" {% if settingsCRS=="EPSG:5847" %}selected{% endif %}>
                        SWEREF 99 13 30 + RH2000 height</option>
                    <option value="EPSG:5848" {% if settingsCRS=="EPSG:5848" %}selected{% endif %}>
                        SWEREF 99 15 00 + RH2000 height</option>
                </select>
                <input type="hidden" name="defaultCRS" id="defaultCRS" value="{{settingsCRS}}">
                <button type="button" id="exportProject" class="ms-2">Exportera</button>
            </div>
        </form>
    </div>
</div>
<hr>
{% endif %}

{% if path %}
<span id="path" data-path="{{path}}"></span>
<span class="folder"><a href="{{ url_for('repo_content', owner=owner, repo_name=repo_name, path='') }}">Root</a></span>
{% for current_path, part in current_paths %}
/ <span class="folder"><a href="{{ url_for('repo_content', owner=owner, repo_name=repo_name, path=current_path) }}">{{
        part }}</a></span>
{% endfor %}
{% else %}
<span id="path" data-path="/"></span>
{% endif %}

<!-- Fil- och mappstruktur -->
{% set delimiter = '' %}
{% if path %}
{% set delimiter = '/' %}
{% endif %}
<ul class="file-list">
    {% for dir in dirs %}
    <li class="folder">
        <span class="file-type folder-icon"></span>
        <a href="{{ url_for('repo_content', owner=owner, repo_name=repo_name, path=path + delimiter + dir['name']) }}">{{
            dir['name'] }}</a>
    </li>
    {% endfor %}
    {% for file in files %}
    <li>
        <span class="file-type file-icon"></span>
        <a href="#" class="edit-file-link" data-filepath="{{ path + '/' + file['name'] }}">{{
            file['name']
            }}</a>
    </li>
    {% endfor %}
</ul>